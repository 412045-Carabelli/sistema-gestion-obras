import{a as ye,b as xe,c as ge,d as _e}from"./chunk-7EI6F5WS.js";import{a as me}from"./chunk-XAMQR3BY.js";import{a as ie}from"./chunk-4BI7NTQR.js";import{e as re,i as le,l as de}from"./chunk-WA2J6DLI.js";import"./chunk-XZVY7D3K.js";import{a as ue}from"./chunk-6QB4PU6K.js";import{b as ce,c as pe}from"./chunk-WXQODJCJ.js";import"./chunk-BBQRPO7P.js";import{f as ne,g as ae}from"./chunk-V6H4TXMQ.js";import{l as se}from"./chunk-VHDVROXF.js";import"./chunk-N52SNE3S.js";import"./chunk-F2X3VGZZ.js";import{b as K,e as Q,h as X,j as Y,m as $,o as ee,s as te,t as oe}from"./chunk-IZVSUXNV.js";import"./chunk-LSHC46HD.js";import"./chunk-4BJQ3EOG.js";import"./chunk-MLMYHGGX.js";import"./chunk-42DWQLJE.js";import"./chunk-XQ2VYUTW.js";import"./chunk-MX3PZFJO.js";import"./chunk-LXJ5KELJ.js";import"./chunk-CV2ZWZQE.js";import{E as I,I as J,k as q,q as Z,r as H}from"./chunk-G4GGURKU.js";import"./chunk-5GYOOLE2.js";import{$ as R,$b as L,Bb as O,Gb as C,Hb as c,Ma as l,Ra as T,Rb as s,Sb as k,Tb as f,Vb as p,Wb as m,Xb as u,Ya as N,Yb as U,Zb as A,a as P,aa as g,b as M,ba as _,cb as v,e as D,f as B,hc as y,ic as j,ja as z,jc as E,lb as b,qb as S,vb as r,wb as a,xb as G}from"./chunk-HE3ZW6WA.js";var W=D(ye()),V=D(xe());var Pe=()=>({label:"Pago",value:"PAGO"}),ve=()=>({label:"Cobro",value:"COBRO"}),be=(d,t)=>[d,t],Se=()=>({label:"Total",value:"TOTAL"}),Ee=()=>({label:"Parcial",value:"PARCIAL"});function we(d,t){d&1&&(r(0,"tr",35)(1,"th",36),s(2,"Proveedor"),a(),r(3,"th",36),s(4,"Descripci\xF3n"),a(),r(5,"th",36),s(6,"Cantidad"),a(),r(7,"th",36),s(8,"Precio Unit."),a(),r(9,"th",36),s(10,"Beneficio (%)"),a(),r(11,"th",36),s(12,"Estado de pago"),a(),r(13,"th",36),s(14,"Total"),a(),r(15,"th",36),s(16,"Acciones"),a()())}function Me(d,t){if(d&1&&(r(0,"span",48),s(1),a()),d&2){let e=c(3);l(),f(" Global (",e.beneficioGlobal,"%) ")}}function Te(d,t){if(d&1){let e=O();r(0,"input",55),u("ngModelChange",function(n){g(e);let i=c().$implicit;return m(i.beneficio,n)||(i.beneficio=n),_(n)}),C("input",function(){g(e);let n=c().$implicit,i=c(2);return _(i.recalcularEnEdicion(n))}),a()}if(d&2){let e=c().$implicit;p("ngModel",e.beneficio),b("disabled",!e.enEdicion)}}function Oe(d,t){if(d&1){let e=O();r(0,"p-button",56),C("onClick",function(){g(e);let n=c().$implicit,i=c(2);return _(i.habilitarEdicion(n))}),a()}}function Ae(d,t){if(d&1){let e=O();r(0,"p-button",57),C("onClick",function(){g(e);let n=c().$implicit,i=c(2);return _(i.guardarEdicion(n))}),a(),r(1,"p-button",58),C("onClick",function(){g(e);let n=c().$implicit;return _(n.enEdicion=!1)}),a()}}function Fe(d,t){if(d&1){let e=O();r(0,"tr",37)(1,"td",38)(2,"p-select",39),u("ngModelChange",function(n){let i=g(e).$implicit;return m(i.id_proveedor,n)||(i.id_proveedor=n),_(n)}),a()(),r(3,"td",38)(4,"input",40),u("ngModelChange",function(n){let i=g(e).$implicit;return m(i.descripcion,n)||(i.descripcion=n),_(n)}),a()(),r(5,"td",38)(6,"div",41)(7,"div",42)(8,"input",43),u("ngModelChange",function(n){let i=g(e).$implicit;return m(i.cantidad,n)||(i.cantidad=n),_(n)}),C("input",function(){let n=g(e).$implicit,i=c(2);return _(i.recalcularEnEdicion(n))}),a()(),r(9,"div",44)(10,"input",45),u("ngModelChange",function(n){let i=g(e).$implicit;return m(i.unidad,n)||(i.unidad=n),_(n)}),a()()()(),r(11,"td",46)(12,"input",47),u("ngModelChange",function(n){let i=g(e).$implicit;return m(i.precio_unitario,n)||(i.precio_unitario=n),_(n)}),C("input",function(){let n=g(e).$implicit,i=c(2);return _(i.recalcularEnEdicion(n))}),a()(),r(13,"td",46),v(14,Me,2,1,"span",48)(15,Te,1,2,"input",49),a(),r(16,"td",38)(17,"p-select",50),C("ngModelChange",function(n){let i=g(e).$implicit,x=c(2);return _(x.actualizarEstadoPago(i,n))}),u("ngModelChange",function(n){let i=g(e).$implicit;return m(i.estado_pago,n)||(i.estado_pago=n),_(n)}),a()(),r(18,"td",51),s(19),y(20,"currency"),a(),r(21,"td",38)(22,"div",52),v(23,Oe,1,0,"p-button",53)(24,Ae,2,0),r(25,"p-button",54),C("onClick",function(){let n=g(e).$implicit,i=c(2);return _(i.eliminarCosto(n))}),a()()()()}if(d&2){let e=t.$implicit,o=t.rowIndex,n=c(2);b("ngClass",o%2===0?"bg-white":"bg-gray-50"),l(2),p("ngModel",e.id_proveedor),b("disabled",!e.enEdicion)("options",n.proveedores),l(2),p("ngModel",e.descripcion),b("disabled",!e.enEdicion),l(4),p("ngModel",e.cantidad),b("disabled",!e.enEdicion),l(2),p("ngModel",e.unidad),b("disabled",!e.enEdicion),l(2),p("ngModel",e.precio_unitario),b("disabled",!e.enEdicion),l(2),S(n.usarBeneficioGlobal?14:15),l(3),p("ngModel",e.estado_pago),b("disabled",e.enEdicion)("options",n.estadosPagoRecords),l(2),f(" ",j(20,19,e.total)," "),l(4),S(e.enEdicion?-1:23),l(),S(e.enEdicion?24:-1)}}function Ie(d,t){if(d&1&&(r(0,"tr",61)(1,"td",62),s(2),a(),r(3,"td",68),s(4),y(5,"currency"),a()()),d&2){let e=c(3);l(2),f(" Beneficio Global (",e.beneficioGlobal,"%): "),l(2),f(" ",E(5,2,e.calcularTotal()*(e.beneficioGlobal/100),"ARS")," ")}}function We(d,t){if(d&1&&(r(0,"tr",59)(1,"td",60),s(2,"Subtotal:"),a(),r(3,"td",38),s(4),y(5,"currency"),a()(),v(6,Ie,6,5,"tr",61),r(7,"tr",61)(8,"td",62),s(9),a(),r(10,"td",63),s(11),y(12,"currency"),a()(),r(13,"tr",64)(14,"td",60),s(15,"Presupuesto Total:"),a(),r(16,"td",65),s(17),y(18,"currency"),a()(),r(19,"tr",61)(20,"td",62),s(21,"Pagado:"),a(),r(22,"td",66),s(23),y(24,"currency"),a()(),r(25,"tr",61)(26,"td",62),s(27,"Pendiente:"),a(),r(28,"td",67),s(29),y(30,"currency"),a()()),d&2){let e=c(2);l(4),k(E(5,7,e.calcularTotal(),"ARS")),l(2),S(e.usarBeneficioGlobal?6:-1),l(3),f(" Comisi\xF3n (",e.comision,"%): "),l(2),f(" ",E(12,10,e.tieneComision?e.calcularTotal()*e.comision/100:0,"ARS")," "),l(6),f(" ",E(18,13,e.getPresupuestoTotal(),"ARS")," "),l(6),f(" ",E(24,16,e.calcularTotalPorEstado("PAGADO"),"ARS")," "),l(6),f(" ",E(30,19,e.calcularTotalPorEstado("PENDIENTE"),"ARS")," ")}}function Ve(d,t){if(d&1&&(r(0,"p-table",22),v(1,we,17,0,"ng-template",32)(2,Fe,26,21,"ng-template",33)(3,We,31,22,"ng-template",34),a()),d&2){let e=c();b("value",e.costosFiltrados)}}function Be(d,t){d&1&&(r(0,"div",23),s(1," No hay costos cargados para esta obra. "),a())}function ze(d,t){if(d&1&&(r(0,"div",31),s(1),a()),d&2){let e=c();l(),f(" ",e.errorApi," ")}}W.default.vfs=V.default.vfs;var Ce=class d{constructor(t,e,o,n){this.estadoPagoService=t;this.costosService=e;this.messageService=o;this.transaccionesService=n}obra;proveedores=[];costos=[];usarBeneficioGlobal=!1;beneficioGlobal=0;tieneComision=!1;comision=0;costosActualizados=new z;movimientoCreado=new z;costosFiltrados=[];estadosPagoRecords=[];loading=!0;nuevoCosto=this.getNuevoCostoBase();pdfMakeReady=!1;modalPagoVisible=!1;costoPendientePago=null;estadoPendientePago=null;transaccionForm={};errorApi;ngOnInit(){this.costos?.length>0&&this.inicializarCostos(),this.cargarEstadosDePago()}ngOnChanges(t){t.costos&&this.costos?.length>0&&this.inicializarCostos(),(t.beneficioGlobal||t.tieneComision)&&(this.costosFiltrados=this.costosFiltrados.map(e=>P({},e)),this.costosFiltrados.forEach(e=>this.recalcularEnEdicion(e)))}actualizarEstadoPago(t,e){if((t.estado_pago==="PAGADO"||t.estado_pago==="PARCIAL")&&e==="PENDIENTE"){this.transaccionesService.deleteByCosto(t.id).subscribe({next:()=>this.actualizarEstadoPagoDirecto(t,e),error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:this.getErrorMessage(n,"No se pudo eliminar el movimiento asociado")})}});return}if(e==="PAGADO"||e==="PARCIAL"){let n=e==="PAGADO"?"TOTAL":e==="PARCIAL"?"PARCIAL":"TOTAL";this.costoPendientePago=t,this.estadoPendientePago=e,this.errorApi=void 0,this.transaccionForm={id_obra:this.obra.id,id_asociado:t.id_proveedor,tipo_asociado:"PROVEEDOR",tipo_transaccion:"PAGO",tipo_movimiento:"PAGO",monto:t.total??0,forma_pago:n,medio_pago:"Transferencia",fecha:new Date().toISOString().slice(0,10),observacion:""},this.modalPagoVisible=!0;return}this.actualizarEstadoPagoDirecto(t,e)}agregarCosto(){if(!this.nuevoCosto.descripcion||!this.nuevoCosto.id_proveedor){this.messageService.add({severity:"warn",summary:"Datos incompletos",detail:"Completa proveedor y descripci\xF3n para agregar el costo."});return}let t=this.calcularMontosPayload(this.nuevoCosto);this.costosService.createCosto(M(P({},t),{id_obra:this.obra.id})).subscribe({next:e=>{let o=M(P(P({},e),t),{enEdicion:!1});this.costosFiltrados=[...this.costosFiltrados,o],this.costosActualizados.emit(this.costosFiltrados),this.nuevoCosto=this.getNuevoCostoBase(),this.messageService.add({severity:"success",summary:"Costo agregado",detail:"Se agreg\xF3 un nuevo costo a la matriz."})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo crear el costo."})}})}habilitarEdicion(t){t.enEdicion=!0}recalcularEnEdicion(t){let{subtotal:e,total:o}=this.calcularMontosPayload(t);t.subtotal=e,t.total=o}guardarEdicion(t){let e=this.calcularMontosPayload(t);this.costosService.updateCosto(t.id,e).subscribe({next:o=>{Object.assign(t,o,e,{enEdicion:!1}),this.costosActualizados.emit([...this.costosFiltrados]),this.messageService.add({severity:"success",summary:"Costo actualizado",detail:"Los cambios se guardaron correctamente."})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo actualizar el costo."})}})}eliminarCosto(t){t.id&&this.costosService.deleteCosto(t.id).subscribe({next:()=>{this.costosFiltrados=this.costosFiltrados.filter(e=>e.id!==t.id),this.costosActualizados.emit(this.costosFiltrados),this.messageService.add({severity:"success",summary:"Costo eliminado",detail:"El costo fue eliminado de la matriz."})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el costo."})}})}confirmarPago(){if(!this.costoPendientePago||!this.estadoPendientePago){this.modalPagoVisible=!1;return}let t=(this.transaccionForm.forma_pago??(this.estadoPendientePago==="PAGADO"?"TOTAL":this.estadoPendientePago==="PARCIAL"?"PARCIAL":"TOTAL")).toString().toUpperCase(),e=Number(this.costoPendientePago.total??0),o=Number(this.transaccionForm.monto??this.costoPendientePago.total??0),n={id_obra:this.obra.id,id_asociado:this.costoPendientePago.id_proveedor,tipo_asociado:"PROVEEDOR",tipo_transaccion:this.transaccionForm.tipo_transaccion||"PAGO",tipo_movimiento:this.transaccionForm.tipo_movimiento||"PAGO",monto:o,forma_pago:t,medio_pago:this.transaccionForm.medio_pago??"Transferencia",fecha:this.transaccionForm.fecha??new Date().toISOString(),observacion:this.transaccionForm.observacion??"",id_costo:this.costoPendientePago.id};this.errorApi=void 0,this.transaccionesService.create(n).subscribe({next:()=>{this.modalPagoVisible=!1,this.actualizarEstadoPagoDirecto(this.costoPendientePago,this.estadoPendientePago),this.costoPendientePago=null,this.estadoPendientePago=null,this.movimientoCreado.emit()},error:i=>{this.errorApi=this.getErrorMessage(i,"No se pudo registrar la transaccion")}})}cancelarPago(){this.modalPagoVisible=!1,this.costoPendientePago=null,this.estadoPendientePago=null}calcularTotal(){return this.costosFiltrados.reduce((t,e)=>t+(e.total??0),0)}calcularTotalPorEstado(t){return this.costosFiltrados.filter(e=>(e.estado_pago_value||"").toUpperCase()===(t||"").toUpperCase()).reduce((e,o)=>e+(o.total??0),0)}getPresupuestoTotal(){let t=this.calcularTotal(),e=this.tieneComision?t*(this.comision/100):0;return Math.round(t+e)}proveedoresFilter(t){return this.proveedores?.find(e=>Number(e.id)===Number(t))}exportarPDF(){return B(this,null,function*(){this.ensurePdfMakeReady();let t=this.obra,e=t.cliente,o=this.costosFiltrados??[],n=yield this.obtenerLogoDataUrl(),i=String(t?.id??0).padStart(5,"0"),x=new Date().toLocaleDateString("es-AR"),F=o.map(w=>[{text:w.descripcion,fontSize:9},{text:w.unidad||"-",fontSize:9,alignment:"center"},{text:String(w.cantidad??0),fontSize:9,alignment:"center"},{text:(w.subtotal??0).toLocaleString("es-AR",{style:"currency",currency:"ARS"}),fontSize:9,alignment:"right"}]),h=o.reduce((w,he)=>w+(he.subtotal??0),0),fe={pageMargins:[20,20,20,20],content:[n?{image:n,width:620,alignment:"center",margin:[0,0,0,12]}:{text:"",margin:[0,0,0,12]},{text:`

COTIZACI\xD3N`,fontSize:16,bold:!0,alignment:"center"},{text:`
`},{columns:[[{text:"Cliente",bold:!0},{text:e?.nombre??"---"},{text:`CUIT: ${e?.cuit??"-"}`,fontSize:9},{text:`Condici\xF3n IVA: ${e?.condicion_iva??"-"}`,fontSize:9},{text:`Tel: ${e?.telefono??"-"}`,fontSize:9},{text:`Email: ${e?.email??"-"}`,fontSize:9}],[{text:"Obra",bold:!0},{text:t?.nombre??"---"},{text:t?.direccion??"",fontSize:9},{text:`Licitaci\xF3n/Obra: ${i}`,fontSize:10,margin:[0,5,0,0]}],[{text:"Fecha",bold:!0},{text:x}]]},{text:`

`},{table:{widths:["*",50,50,70],body:[[{text:"DESCRIPCI\xD3N",bold:!0},{text:"UNI.",bold:!0,alignment:"center"},{text:"CANT.",bold:!0,alignment:"center"},{text:"Subtotal",bold:!0,alignment:"right"}],...F]}},{text:`
`},{alignment:"right",table:{widths:["*",120],body:[["Subtotal",h.toLocaleString("es-AR",{style:"currency",currency:"ARS"})],["Presupuesto Total",h.toLocaleString("es-AR",{style:"currency",currency:"ARS"})]]},layout:"noBorders"},{text:`

`},{text:"Validez de oferta",bold:!0},{text:`El presente presupuesto tiene una validez de 7 d\xEDas a partir de la fecha.
`,fontSize:10},{text:"Plazos de obra",bold:!0},{text:`7 d\xEDas h\xE1biles.
`,fontSize:10},{text:"Forma de pago",bold:!0},{text:`Al finalizar las tareas.
`,fontSize:10},{text:"Observaciones",bold:!0},{text:this.obra.notas??"-",fontSize:10}]};W.default.createPdf(fe).download(`COTIZACI\xD3N_${i}.pdf`)})}ensurePdfMakeReady(){if(this.pdfMakeReady)return;let t=V.default.pdfMake?.vfs??V.default.vfs;t&&(W.default.vfs=t,this.pdfMakeReady=!0)}obtenerLogoDataUrl(){return B(this,null,function*(){let t=window.location.origin,e=[`${t}/assets/logo-meliquina.png`,`${t}/logo-meliquina.png`];for(let o of e)try{let n=yield fetch(o);if(!n.ok)continue;let i=yield n.blob();return yield new Promise((x,F)=>{let h=new FileReader;h.onloadend=()=>{typeof h.result=="string"?x(h.result):F(new Error("Resultado de logo no es una cadena"))},h.onerror=()=>F(new Error("No se pudo leer el logo")),h.readAsDataURL(i)})}catch{}console.error("No se pudo cargar el logo de la cotizaci\xC3\u2021\xC3\xBCn",{intentos:e})})}inicializarCostos(){this.costosFiltrados=this.costos.map(t=>M(P({},t),{id_proveedor:t.id_proveedor??t.proveedor?.id,precio_unitario:t.precio_unitario??0,subtotal:t.subtotal??0,total:t.total??0,beneficio:t.beneficio??0,estado_pago:t.estado_pago,enEdicion:!1}))}calcularMontosPayload(t){let e=Number(t.cantidad??0),o=Number(t.precio_unitario??0),n=e*o,i=this.usarBeneficioGlobal?this.beneficioGlobal:Number(t.beneficio??0),x=n*(1+i/100);return{id_proveedor:Number(t.id_proveedor),descripcion:t.descripcion??"",unidad:t.unidad??"",cantidad:e,precio_unitario:o,beneficio:i,subtotal:n,total:x,estado_pago:t.estado_pago??"PENDIENTE"}}getNuevoCostoBase(){return{descripcion:"",cantidad:1,precio_unitario:0,unidad:"",id_proveedor:void 0,beneficio:this.usarBeneficioGlobal?this.beneficioGlobal:0,estado_pago:"PENDIENTE"}}cargarEstadosDePago(){this.estadoPagoService.getEstadosPago().subscribe({next:t=>{this.estadosPagoRecords=t,this.loading=!1},error:t=>{console.error("Error al cargar estados de pago",t),this.loading=!1}})}actualizarEstadoPagoDirecto(t,e){let o=this.estadosPagoRecords.find(n=>n.name===e);o&&this.costosService.updateEstadoPago(t.id,e).subscribe({next:()=>{t.estado_pago=o.name;let n=this.costos.findIndex(i=>i.id===t.id);n!==-1&&(this.costos[n]=M(P({},this.costos[n]),{estado_pago:o.name})),this.costosActualizados.emit([...this.costos]),this.messageService.add({severity:"success",summary:"Estado actualizado",detail:`El costo fue marcado como "${o.label}"`})},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:this.getErrorMessage(n,"No se pudo actualizar el estado de pago")})}})}getErrorMessage(t,e){if(!t)return e;let o=t.error;return typeof o=="string"&&o.trim()?o:o?o.error||o.mensaje||o.message||o.detail||e:typeof t.message=="string"&&t.message.trim()?t.message:e}static \u0275fac=function(e){return new(e||d)(T(ge),T(_e),T(I),T(ue))};static \u0275cmp=N({type:d,selectors:[["app-obra-presupuesto"]],inputs:{obra:"obra",proveedores:"proveedores",costos:"costos",usarBeneficioGlobal:"usarBeneficioGlobal",beneficioGlobal:"beneficioGlobal",tieneComision:"tieneComision",comision:"comision"},outputs:{costosActualizados:"costosActualizados",movimientoCreado:"movimientoCreado"},features:[U([I]),R],decls:67,vars:30,consts:[["position","bottom-right"],[1,"p-4","space-y-5"],[1,"flex","justify-between","items-center","flex-wrap","gap-3"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-500","text-sm","mt-1"],[1,"flex","gap-5","items-center"],[1,"text-sm","text-gray-700"],["icon","pi pi-file-pdf","label","Exportar PDF","styleClass","p-button-md p-button-primary",3,"onClick"],[1,"grid","grid-cols-1","lg:grid-cols-5","gap-3","bg-gray-50","border","border-dashed","border-gray-200","p-3","rounded-lg"],[1,"flex","flex-col","gap-1"],[1,"text-xs","text-gray-600"],["optionLabel","nombre","optionValue","id","placeholder","Proveedor","styleClass","w-full",3,"ngModelChange","ngModel","options"],[1,"flex","flex-col","gap-1","lg:col-span-2"],["pInputText","","placeholder","Descripci\xF3n","type","text",1,"w-full",3,"ngModelChange","ngModel"],[1,"flex","gap-2"],[1,"flex","flex-col","gap-1","w-1/3"],["min","0","pInputText","","placeholder","Cant.","type","number",1,"w-full",3,"ngModelChange","ngModel"],["min","0","pInputText","","placeholder","Precio","type","number",1,"w-full",3,"ngModelChange","ngModel"],["pInputText","","placeholder","Ej: m2","type","text",1,"w-full",3,"ngModelChange","ngModel"],[1,"flex","gap-2","items-end"],["min","0","pInputText","","placeholder","%","type","number",1,"w-20",3,"ngModelChange","ngModel","disabled"],["icon","pi pi-plus","label","Agregar",3,"onClick"],["responsiveLayout","scroll",1,"text-sm","p-datatable-sm","border","border-gray-200","rounded-lg","overflow-hidden",3,"value"],[1,"text-center","text-gray-500","py-10"],[3,"closed","confirmed","visible","title"],[1,"flex","flex-col","gap-3","py-2"],[1,"text-sm","font-medium","text-gray-700"],["optionLabel","label","optionValue","value","styleClass","w-full",3,"ngModelChange","ngModel","options"],["pInputText","","type","number",1,"w-full",3,"ngModelChange","ngModel"],["pInputText","","type","date",1,"w-full",3,"ngModelChange","ngModel"],["rows","3",1,"w-full","border","rounded","p-2","text-sm",3,"ngModelChange","ngModel"],[1,"text-sm","text-red-600","bg-red-50","border","border-red-200","rounded","p-2"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],[1,"bg-gray-50","text-gray-700"],[1,"text-left","px-3","py-2","font-semibold"],[1,"hover:bg-gray-50","transition",3,"ngClass"],[1,"px-3","py-2"],["optionLabel","nombre","optionValue","id","placeholder","Proveedor","styleClass","w-full",3,"ngModelChange","ngModel","disabled","options"],["pInputText","","type","text",1,"w-full",3,"ngModelChange","ngModel","disabled"],[1,"flex","gap-2","items-center"],[1,"flex","flex-col","gap-1","w-20"],["min","0","pInputText","","type","number",1,"w-full",3,"ngModelChange","input","ngModel","disabled"],[1,"flex","flex-col","gap-1","w-16"],["pInputText","","placeholder","Unidad","type","text",1,"w-full",3,"ngModelChange","ngModel","disabled"],[1,"px-3","py-2","text-right"],["min","0","pInputText","","type","number",1,"w-full","text-right",3,"ngModelChange","input","ngModel","disabled"],[1,"text-gray-500","text-xs"],["pInputText","","type","number",1,"w-16","text-right",3,"ngModel","disabled"],["optionLabel","label","optionValue","name","styleClass","w-40",3,"ngModelChange","ngModel","disabled","options"],[1,"px-3","py-2","text-right","font-semibold"],[1,"flex","gap-1","justify-end"],["icon","pi pi-pencil","styleClass","p-button-text p-button-sm"],["icon","pi pi-trash","styleClass","p-button-danger p-button-text p-button-sm",3,"onClick"],["pInputText","","type","number",1,"w-16","text-right",3,"ngModelChange","input","ngModel","disabled"],["icon","pi pi-pencil","styleClass","p-button-text p-button-sm",3,"onClick"],["icon","pi pi-check","styleClass","p-button-success p-button-sm",3,"onClick"],["icon","pi pi-times","styleClass","p-button-secondary p-button-sm",3,"onClick"],[1,"bg-gray-100","font-semibold"],["colspan","6",1,"text-right","px-3","py-2"],[1,"bg-gray-50","text-sm"],["colspan","6",1,"text-right","px-3","py-2","text-gray-600"],[1,"px-3","py-2","text-indigo-600","font-medium"],[1,"bg-gray-200","font-bold"],[1,"px-3","py-2","text-green-700"],[1,"px-3","py-2","text-green-600","font-medium"],[1,"px-3","py-2","text-amber-600","font-medium"],[1,"px-3","py-2","text-blue-600","font-medium"]],template:function(e,o){e&1&&(G(0,"p-toast",0),r(1,"div",1)(2,"div",2)(3,"div")(4,"h2",3),s(5,"Presupuesto"),a(),r(6,"p",4),s(7," Matriz de costos detallada de la obra "),a()(),r(8,"div",5)(9,"p",6)(10,"strong"),s(11,"Beneficio:"),a(),s(12),a(),r(13,"p-button",7),C("onClick",function(){return o.exportarPDF()}),a()()(),r(14,"div",8)(15,"div",9)(16,"label",10),s(17,"Proveedor"),a(),r(18,"p-select",11),u("ngModelChange",function(i){return m(o.nuevoCosto.id_proveedor,i)||(o.nuevoCosto.id_proveedor=i),i}),a()(),r(19,"div",12)(20,"label",10),s(21,"Descripci\xF3n"),a(),r(22,"input",13),u("ngModelChange",function(i){return m(o.nuevoCosto.descripcion,i)||(o.nuevoCosto.descripcion=i),i}),a()(),r(23,"div",14)(24,"div",15)(25,"label",10),s(26,"Cantidad"),a(),r(27,"input",16),u("ngModelChange",function(i){return m(o.nuevoCosto.cantidad,i)||(o.nuevoCosto.cantidad=i),i}),a()(),r(28,"div",15)(29,"label",10),s(30,"Precio unitario"),a(),r(31,"input",17),u("ngModelChange",function(i){return m(o.nuevoCosto.precio_unitario,i)||(o.nuevoCosto.precio_unitario=i),i}),a()(),r(32,"div",15)(33,"label",10),s(34,"Unidad"),a(),r(35,"input",18),u("ngModelChange",function(i){return m(o.nuevoCosto.unidad,i)||(o.nuevoCosto.unidad=i),i}),a()()(),r(36,"div",19)(37,"div",9)(38,"label",10),s(39,"Beneficio (%)"),a(),r(40,"input",20),u("ngModelChange",function(i){return m(o.nuevoCosto.beneficio,i)||(o.nuevoCosto.beneficio=i),i}),a()(),r(41,"p-button",21),C("onClick",function(){return o.agregarCosto()}),a()()(),v(42,Ve,4,1,"p-table",22)(43,Be,2,0,"div",23),a(),r(44,"app-modal",24),C("closed",function(){return o.cancelarPago()})("confirmed",function(){return o.confirmarPago()}),r(45,"div",25)(46,"div",9)(47,"label",26),s(48,"Tipo de movimiento"),a(),r(49,"p-select",27),u("ngModelChange",function(i){return m(o.transaccionForm.tipo_movimiento,i)||(o.transaccionForm.tipo_movimiento=i),i}),a()(),r(50,"div",9)(51,"label",26),s(52,"Monto"),a(),r(53,"input",28),u("ngModelChange",function(i){return m(o.transaccionForm.monto,i)||(o.transaccionForm.monto=i),i}),a()(),r(54,"div",9)(55,"label",26),s(56,"Forma de pago"),a(),r(57,"p-select",27),u("ngModelChange",function(i){return m(o.transaccionForm.forma_pago,i)||(o.transaccionForm.forma_pago=i),i}),a()(),r(58,"div",9)(59,"label",26),s(60,"Fecha"),a(),r(61,"input",29),u("ngModelChange",function(i){return m(o.transaccionForm.fecha,i)||(o.transaccionForm.fecha=i),i}),a()(),r(62,"div",9)(63,"label",26),s(64,"Observaci\xF3n"),a(),r(65,"textarea",30),u("ngModelChange",function(i){return m(o.transaccionForm.observacion,i)||(o.transaccionForm.observacion=i),i}),a()(),v(66,ze,2,1,"div",31),a()()),e&2&&(l(12),f(" ",o.usarBeneficioGlobal?"Global ("+o.beneficioGlobal+"%)":"Individual"," "),l(6),p("ngModel",o.nuevoCosto.id_proveedor),b("options",o.proveedores),l(4),p("ngModel",o.nuevoCosto.descripcion),l(5),p("ngModel",o.nuevoCosto.cantidad),l(4),p("ngModel",o.nuevoCosto.precio_unitario),l(4),p("ngModel",o.nuevoCosto.unidad),l(5),p("ngModel",o.nuevoCosto.beneficio),b("disabled",o.usarBeneficioGlobal),l(2),S(o.costosFiltrados.length>0?42:43),l(2),b("visible",o.modalPagoVisible)("title","Registrar movimiento de pago"),l(5),p("ngModel",o.transaccionForm.tipo_movimiento),b("options",L(22,be,A(20,Pe),A(21,ve))),l(4),p("ngModel",o.transaccionForm.monto),l(4),p("ngModel",o.transaccionForm.forma_pago),b("options",L(27,be,A(25,Se),A(26,Ee))),l(4),p("ngModel",o.transaccionForm.fecha),l(4),p("ngModel",o.transaccionForm.observacion),l(),S(o.errorApi?66:-1))},dependencies:[H,q,Z,de,le,J,ae,ne,ie,oe,te,re,ee,K,Y,Q,$,X,pe,ce,se,me],encapsulation:2})};export{Ce as ObraPresupuestoComponent};
