import{a as V}from"./chunk-3IQLNM73.js";import{a as $}from"./chunk-BB2Q7CPB.js";import{i as N,j as k,k as F,l as R}from"./chunk-WA2J6DLI.js";import"./chunk-XZVY7D3K.js";import{a as U}from"./chunk-SVAZSSDV.js";import{b as j,c as B}from"./chunk-WXQODJCJ.js";import"./chunk-BBQRPO7P.js";import{f as A,g as L}from"./chunk-V6H4TXMQ.js";import"./chunk-VHDVROXF.js";import"./chunk-N52SNE3S.js";import"./chunk-F2X3VGZZ.js";import"./chunk-IZVSUXNV.js";import"./chunk-LSHC46HD.js";import"./chunk-4BJQ3EOG.js";import{c as P}from"./chunk-MLMYHGGX.js";import"./chunk-42DWQLJE.js";import"./chunk-XQ2VYUTW.js";import"./chunk-MX3PZFJO.js";import"./chunk-LXJ5KELJ.js";import"./chunk-CV2ZWZQE.js";import{E as _,I as O,p as w,r as M}from"./chunk-G4GGURKU.js";import"./chunk-5GYOOLE2.js";import{Bb as S,Gb as D,Hb as p,Ma as a,Ra as f,Rb as r,Sb as u,Tb as y,Ya as x,Yb as I,aa as h,ba as b,cb as d,hc as g,ic as E,jc as T,lb as C,qb as v,vb as i,wb as n,xb as s}from"./chunk-HE3ZW6WA.js";function q(o,t){o&1&&(i(0,"div",1),s(1,"p-progressSpinner",2),n())}function z(o,t){o&1&&(i(0,"tr")(1,"th",7),r(2," Tipo "),s(3,"p-sortIcon",8),n(),i(4,"th"),r(5,"Observacion"),n(),i(6,"th",9),r(7," Fecha "),s(8,"p-sortIcon",10),n(),i(9,"th",11),r(10," Archivo "),s(11,"p-sortIcon",12),n(),i(12,"th"),r(13,"Acciones"),n()())}function G(o,t){if(o&1){let e=S();i(0,"tr")(1,"td"),r(2),g(3,"estadoFormat"),n(),i(4,"td"),r(5),n(),i(6,"td"),r(7),g(8,"date"),n(),i(9,"td")(10,"span",13),r(11),n()(),i(12,"td",14)(13,"p-button",15),D("onClick",function(){let l=h(e).$implicit,m=p(3);return b(m.descargarDocumento(l))}),n()()()}if(o&2){let e=t.$implicit;a(2),u(E(3,5,e.tipo_documento)||"-"),a(3),u(e.observacion||"-"),a(2),u(T(8,7,e.fecha,"dd/MM/yyyy")),a(3),C("title",e.nombre_archivo),a(),y(" ",e.nombre_archivo," ")}}function H(o,t){if(o&1&&(i(0,"p-table",3),d(1,z,14,0,"ng-template",5)(2,G,14,10,"ng-template",6),n()),o&2){let e=p(2);C("value",e.documentos)("paginator",!0)("rows",5)("sortOrder",-1)}}function J(o,t){o&1&&(i(0,"p",4),r(1," No hay documentos registrados para este asociado. "),n())}function K(o,t){if(o&1&&d(0,H,3,4,"p-table",3)(1,J,2,0,"p",4),o&2){let e=p();v(e.documentos.length>0?0:1)}}var W=class o{constructor(t,e){this.documentosService=t;this.messageService=e}clienteId;asociadoId;tipoAsociado="CLIENTE";documentos=[];loading=!0;ngOnInit(){let t=this.asociadoId??this.clienteId;t&&this.cargarDocumentos(t)}cargarDocumentos(t){this.loading=!0,this.documentosService.getDocumentosPorAsociado(this.tipoAsociado,t).subscribe({next:e=>{console.log(e),this.documentos=e,this.loading=!1},error:()=>{this.documentos=[],this.loading=!1,this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los documentos del cliente."})}})}descargarDocumento(t){this.documentosService.downloadDocumento(t.id_documento).subscribe({next:e=>{let c=new Blob([e]),l=window.URL.createObjectURL(c),m=document.createElement("a");m.href=l,m.download=t.nombre_archivo||"documento",m.click(),window.URL.revokeObjectURL(l),this.messageService.add({severity:"success",summary:"Descarga iniciada",detail:t.nombre_archivo})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo descargar el documento."})}})}static \u0275fac=function(e){return new(e||o)(f($),f(_))};static \u0275cmp=x({type:o,selectors:[["app-clientes-documentos"]],inputs:{clienteId:"clienteId",asociadoId:"asociadoId",tipoAsociado:"tipoAsociado"},features:[I([_])],decls:3,vars:1,consts:[["position","bottom-right"],[1,"flex","justify-center","items-center","min-h-[40vh]"],["styleClass","w-12 h-12","strokeWidth","4","animationDuration",".8s"],["responsiveLayout","scroll","sortField","fecha",1,"p-datatable-sm","border","border-gray-200","rounded-lg","overflow-hidden",3,"value","paginator","rows","sortOrder"],[1,"text-center","text-gray-500","py-10"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","tipo_documento"],["field","tipo_documento"],["pSortableColumn","fecha"],["field","fecha"],["pSortableColumn","nombre_archivo"],["field","nombre_archivo"],[1,"truncate-text",3,"title"],[1,"space-x-2"],["icon","pi pi-download","pTooltip","Descargar","styleClass","p-button-sm p-button-secondary","tooltipPosition","top",3,"onClick"]],template:function(e,c){e&1&&(s(0,"p-toast",0),d(1,q,2,0,"div",1)(2,K,2,1)),e&2&&(a(),v(c.loading?1:2))},dependencies:[M,w,R,N,O,k,F,L,A,B,j,P,U,V],encapsulation:2})};export{W as ClientesDocumentosComponent};
