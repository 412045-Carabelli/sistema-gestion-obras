# ============================
# ? PROD - RENDER
# ============================
server.port=${PORT:8080}

# ------------------------------
# ? Service base URLs
# ------------------------------
obras.service.base-url=${OBRAS_BASE_URL:https://obras-service.onrender.com}
clientes.service.base-url=${CLIENTES_BASE_URL:https://clientes-service.onrender.com}
proveedores.service.base-url=${PROVEEDORES_BASE_URL:https://proveedores-service.onrender.com}
documentos.service.base-url=${DOCUMENTOS_BASE_URL:https://documentos-service.onrender.com}
transacciones.service.base-url=${TRANSACCIONES_BASE_URL:https://transacciones-service.onrender.com}
reportes.service.base-url=${REPORTES_BASE_URL:https://reportes-service.onrender.com}

# ------------------------------
# ? Gateway routes
# ------------------------------
spring.cloud.gateway.routes[0].id=obras
spring.cloud.gateway.routes[0].uri=${obras.service.base-url}
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/obras/**

spring.cloud.gateway.routes[1].id=clientes
spring.cloud.gateway.routes[1].uri=${clientes.service.base-url}
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/clientes/**

spring.cloud.gateway.routes[2].id=proveedores
spring.cloud.gateway.routes[2].uri=${proveedores.service.base-url}
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/proveedores/**

spring.cloud.gateway.routes[3].id=tipos-proveedor
spring.cloud.gateway.routes[3].uri=${proveedores.service.base-url}
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/tipos-proveedor/**

spring.cloud.gateway.routes[4].id=documentos
spring.cloud.gateway.routes[4].uri=${documentos.service.base-url}
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/documentos/**

spring.cloud.gateway.routes[5].id=transacciones
spring.cloud.gateway.routes[5].uri=${transacciones.service.base-url}
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/transacciones/**

spring.cloud.gateway.routes[6].id=reportes
spring.cloud.gateway.routes[6].uri=${reportes.service.base-url}
spring.cloud.gateway.routes[6].predicates[0]=Path=/api/reportes/**

# ------------------------------
# ? BFF controller endpoints
# ------------------------------
services.obras.base-url=${obras.service.base-url}
services.obras.url=${services.obras.base-url}/api/obras
services.obras.costos.url=${services.obras.url}/costos
services.obras.tareas.url=${services.obras.url}/tareas
services.obras.estado_pago.url=${services.obras.url}/estado_pago
services.obras.estado_obra.url=${services.obras.url}/estados

services.clientes.base-url=${clientes.service.base-url}
services.clientes.url=${services.clientes.base-url}/api/clientes

services.proveedores.base-url=${proveedores.service.base-url}
services.proveedores.url=${services.proveedores.base-url}/api/proveedores
services.proveedores.tipo.url=${services.proveedores.url}/tipo_proveedor

services.documentos.base-url=${documentos.service.base-url}
services.documentos.url=${services.documentos.base-url}/api/documentos
services.documentos.tipo.url=${services.documentos.base-url}/api/tipo_documentos

services.transacciones.base-url=${transacciones.service.base-url}
services.transacciones.url=${services.transacciones.base-url}/api/transacciones
services.tipo_transacciones.url=${services.transacciones.base-url}/api/tipo_transaccion

services.reportes.base-url=${reportes.service.base-url}
services.reportes.url=${services.reportes.base-url}/api/reportes

# ------------------------------
# ? CORS configuration (GLOBAL)
# ------------------------------
spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping=true

# Orígenes permitidos (Producción + Local)
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOrigins[0]=https://sistema-gestion-obras.netlify.app
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOrigins[1]=http://localhost:4200

# Métodos y headers permitidos
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedMethods=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedHeaders=*

# Permitir credenciales (cookies / tokens si aplica)
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowCredentials=true
