# ============================
# ? MODO PRODUCCIÓN / DOCKER
# ============================

server.port=8080
spring.application.name=api-gateway
spring.main.web-application-type=reactive

# --- RUTAS (Docker network) ---
spring.cloud.gateway.routes[0].id=obras
spring.cloud.gateway.routes[0].uri=http://obras-service:8081
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/obras/**

spring.cloud.gateway.routes[1].id=clientes
spring.cloud.gateway.routes[1].uri=http://clientes-service:8082
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/clientes/**

spring.cloud.gateway.routes[2].id=proveedores
spring.cloud.gateway.routes[2].uri=http://proveedores-service:8083
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/proveedores/**

spring.cloud.gateway.routes[3].id=documentos
spring.cloud.gateway.routes[3].uri=http://documentos-service:8087
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/documentos/**

spring.cloud.gateway.routes[4].id=transacciones
spring.cloud.gateway.routes[4].uri=http://transacciones-service:8086
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/transacciones/**

spring.cloud.gateway.routes[5].id=reportes
spring.cloud.gateway.routes[5].uri=http://reportes-service:8084
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/reportes/**

# --- URLs INTERNAS ---
services.obras.url=http://obras-service:8081/api/obras
services.clientes.url=http://clientes-service:8082/api/clientes
services.proveedores.url=http://proveedores-service:8083/api/proveedores
services.documentos.url=http://documentos-service:8087/api/documentos
services.transacciones.url=http://transacciones-service:8086/api/transacciones
services.reportes.url=http://reportes-service:8084/api/reportes

# --- CORS ---
spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping=true
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOrigins[0]=http://localhost:4200
spring.cloud.gateway.globalcors.corsConfigurations.[/**].corsConfigurations.[/**].allowedMethods=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedHeaders=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowCredentials=true

# --- PRODUCCIÓN: no ejecutar scripts de inicialización ---
spring.sql.init.mode=never
spring.jpa.hibernate.ddl-auto=none

# --- LOG ---
debug=false
services.facturas.url=http://transacciones-service:8086/api/facturas

# --- WEBCLIENT BUFFER (descargas) ---
spring.codec.max-in-memory-size=20MB
